---
tags:
created:
  - 2025-08-24 23:46
---



## References
---
- [[コンピュータに単語を理解させる方法とは？]]

# カウントベース手法とは？
---
コンピュータに単語の意味を理解させる方法の一つ。
シソーラスの辞書を使った方法では、辞書の中身を人間が整理する手間が必要で大変だった。

だからカウントベース手法では、文章中の特定の単語と別の単語が共起する回数に注目して単語の意味を統計的にコンピュータに理解させようとする。

この手法では、**単語の意味はその単語の周囲の単語によって定義される**という考えが根柢にある。

また、特定の単語の周囲に現れる単語をコンテキストという。
自然言語処理の研究やそれを使ったアプリ開発で使われるテキストデータをコーパスという。

## カウントベース手法の具体的なステップ
1. コンピュータに理解させたい文章を単語ごとに区切る。
2. 区切った単語ごとに、その単語の前後に現れる単語の**出現頻度**をカウントした共起行列を作成
3. 共起行列から取り出した、各単語ベクトルを使って、特定の単語と別の単語の類似度をコサイン類似度を使って計算


## 単純なカウントベース手法の問題
---
しかし、上記のステップでは、特定の単語の前後に現れる単語の出現頻度を計算すると、ある問題が発生する。

それは、実際には関連性の強くない単語を関連性が強いと評価してしまうことがあるということ。

例えば、carという単語と関連性の高い単語を探すことを目的とする。
そして1000単語中にcarという単語の前後にtheが100回、driverが5回現れたとする。

すると、実際にはcarにはdriverという単語のほうがtheよりも関連性が高いにも関わらず、theのほうが関連性が高いとみなされてしまう。

### 改善策
---
特定の単語の前後に現れる単語の単純な出現頻度ではなく、相互情報量を用いる。
相互情報量は、別の単語が単独で現れる回数と特定の単語の前後に現れる回数を考慮して計算される。

$$
PMI(x,y)=log⁡P(x,y)P(x)P(y)\text{PMI}(x, y) = \log \frac{P(x,y)}{P(x)P(y)}
$$

ただし、特定の単語に対する別の単語の共起回数が0だと、以下の問題が発生する
	- 0除算が発生
	- 結果が-∞になる

だから、共起行列では、正の相互情報量を扱う

そのため、相互情報量を使った共起行列をコサイン類似度の計算に使うことでより厳密な単語の類似度の計算が可能になる。


## 相互情報量の確率の考え方
---

ここで出てくる確率は、**すべて「共起イベントの確率」**

### 1. $P(x,y)$ とは？
---

- 意味：全共起イベントの内、ターゲット単語がxでコンテキストがyの確率

    $P(x,y)=C[x,y]NP(x,y) = \frac{C[x,y]}{N}$
    - $C[x,y]C[x,y]$ : 共起行列で (x,y) の出現回数
        
    - $N=∑i,jC[i,j]N = \sum_{i,j} C[i,j]$ : 全ての共起イベントの総数
        

全共起イベントの内、(x, y)が共起する確率

### 2. $P(x)$ とは？
---

- 意味：全共起イベントの内、共起ターゲット単語がxになる確率
    
- 実際には
    
    $P(x)=∑jC[x,j]NP(x) = \frac{\sum_j C[x,j]}{N}$
    
    これは **行和 / N** です。
    
### 3. $P(y)$ とは？
---

- 意味：全共起イベントの内、コンテキスト単語が **y** になる確率。
    
- 実際には
    
    $P(y)=∑iC[i,y]NP(y) = \frac{\sum_i C[i,y]}{N}$
    
    これは **列和 / N** です。
    

---

### 直感的な意味

- 分子 $P(x,y)$ → 実際に (x,y) が一緒に出てくる確率
    
- 分母 $P(x)P(y)$ → 「もし x と y が独立なら、このくらいの確率で出るはず」という期待値
    
- PMI → 実際の共起確率が「独立なら出るはずの確率」と比べてどれくらい偏っているか

---

💡 まとめると：

- $P(x,y)$：ある単語と文脈単語のペアが現れる確率
    
- $P(x)P(x)$：ターゲット単語としてその単語が出る確率
    
- $P(y)P(y)$：コンテキスト単語としてその単語が出る確率


````python
# 行方向に合計すると、ある単語がコンテキスト単語としてどれくらい共起したかの回数を得られる
# 列方向に合計すると、ある単語がターゲット単語としてどれくらい共起したかの回数を得られる
[[0 1 0 0 0 0 0]
 [1 0 1 0 1 1 0]
 [0 1 0 1 0 0 0]
 [0 0 1 0 1 0 0]
 [0 1 0 1 0 0 0]
 [0 1 0 0 0 0 1]
 [0 0 0 0 0 1 0]]
````


## Q1
---
もし「car」と「the」のペアが **とても多く出ている**けど、実際には「the」はどの単語ともよく出ているとします。

👉 このとき PMI(car, the) は高くなると思いますか？低くなると思いますか？

回答○
theはcar以外の単語ともコンテキスト単語として共起している可能性が高いため、ターゲット単語をcarとしたときの同時確率はcarとtheが独立したときの期待値に比べて低いと考える。 したがってPMI(car, the)は低いと考える。 